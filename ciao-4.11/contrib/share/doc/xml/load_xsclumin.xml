<?xml version="1.0"?>
<!DOCTYPE cxchelptopics SYSTEM "CXCHelp.dtd" [
 <!ENTITY pr "sherpa>">
]>
<cxchelptopics>
  <ENTRY pkg="sherpa" key="load_xsclumin"
	 refkeywords="xsclumin clumin load_clumin
                      particle photon
		      component luminosity measure calculate norm
		      normalization sum emin emax
                      loglum lglum lg10lum
		      convolution model
		      x-spec xspec convolution model experimental
		      "
	 seealsogroups="sh.models "
	 displayseealsogroups="" context="models">

    <SYNOPSIS>
      calculate luminosity.
      XSpec convolution model 
      *Experimental*.
    </SYNOPSIS>

    <DESC>
      <PARA>
	A convolution model to calculate the luminosity of other model
	components.
      </PARA>

      <PARA>
	The Sherpa commands
	<HREF link="http://cxc.harvard.edu/sherpa/ahelp/calc_energy_flux.html">calc_energy_flux</HREF>,
	<HREF link="http://cxc.harvard.edu/sherpa/ahelp/calc_photon_flux.html">calc_photon_flux</HREF>,
	and
	<HREF link="http://cxc.harvard.edu/sherpa/ahelp/sample_flux.html">sample_flux</HREF>,
	as well as the 
	<HREF link="http://cxc.harvard.edu/sherpa/threads/sample_flux/">Calculating 
	Model Flux and Flux Uncertainty</HREF> thread
	can also be used. These would then need to be converted to a
        luminosity using your favorite Cosmology. See also
        the calc_kcorr function for applying a K correction to
        a spectral model.
      </PARA>

      <TABLE>
	<CAPTION>xsclumin Parameters</CAPTION>
	<ROW> 
	  <DATA>Number</DATA>
	  <DATA>Name</DATA>
	  <DATA>Description</DATA> 
	</ROW>
	<ROW> 
	  <DATA>1</DATA> <DATA>Emin</DATA>
	  <DATA>Minimum source-frame energy over which luminosity is calculated (keV)</DATA>
	</ROW>
	<ROW> 
	  <DATA>2</DATA> <DATA>Emax</DATA>
	  <DATA>Maximum source-frame energy over which luminosity is calculated (keV)</DATA>
	</ROW>
	<ROW> 
	  <DATA>3</DATA> <DATA>Redshift</DATA>
	  <DATA>Redshift of the source</DATA>
	</ROW>

	<ROW> 
	  <DATA>4</DATA> <DATA>lg10Lum</DATA>
	  <DATA>log (base 10) of the luminosity in erg/s</DATA>
	</ROW>
      </TABLE>

      <PARA title="Loading the X-Spec convolution models">
	Please see
	<HREF link="http://cxc.harvard.edu/ciao/ahelp/xsconvolve.html">ahelp xsconvolve</HREF>
	for information on how to load the model.
      </PARA>

      <LIST>
	<CAPTION>Notes</CAPTION>
	<ITEM>
	  This is an experimental release of the convolution models;
	  please take care when using this model.
	</ITEM>
	<ITEM>
	  When lumin is used with multiple additive models, the
	  normalization of one of the additive models must be
	  fixed to a non-zero value.
	</ITEM>
	<ITEM>
	  The energy range defined by the Emin and Emax parameters
	  must lie inside the energy range of the response matrix.
	</ITEM>
	<ITEM>
	  If the model to which lumin is applied
	  integrates to zero then a divide-by-zero error will occur
	  and the fit will likely fail due to the presence of NaN
	  values.
	</ITEM>
      </LIST>

      <PARA title="XSpec version">
	This information is taken from the
	<HREF link="http://heasarc.gsfc.nasa.gov/docs/xanadu/xspec/manual/manual.html">XSpec
	User's Guide</HREF>.
	Version 12.10.0e of the XSpec
	models is supplied with CIAO 4.11.
      </PARA>

    </DESC>

    <QEXAMPLELIST>
      <QEXAMPLE>
	<SYNTAX>
	  <LINE>&pr; from sherpa_contrib.xspec.xsconvolve import load_xsclumin</LINE>
	  <LINE>&pr; load_xsclumin("clumin")</LINE>
	  <LINE>&pr; xsphabs.gal()</LINE>
	  <LINE>&pr; xspowerlaw.pl()</LINE>
	  <LINE>&pr; xsgaussian.gs()</LINE>
          <LINE>&pr; clumin.emin = 0.5</LINE>
          <LINE>&pr; clumin.emax = 7</LINE>
          <LINE>&pr; clumin.redshift = 0.2</LINE>
	  <LINE>&pr; set_source(clumin(gal * (pl + gs)))</LINE>
	</SYNTAX>
	<DESC>
	  <PARA title="Luminosity of the absorbed model">
	    If the power-law or gaussian normalization is fixed to a non-zero
	    value then the above will calculate
	    the luminosity and error on the entire model (absorbed).
            The redshift and energy range range are 0.2 and 0.5 to 7 keV
            respectively.
	  </PARA>
	</DESC>
      </QEXAMPLE>

      <QEXAMPLE>
	<SYNTAX>
	  <LINE>&pr; set_source(gal * clumin(pl + gs)))</LINE>
	</SYNTAX>
	<DESC>
	  <PARA title="Luminosity of the un-absorbed model">
	    If the power-law or gaussian normalization is fixed to a non-zero
	    value then this calculates the unabsorbed luminosity and error.
	  </PARA>
	</DESC>
      </QEXAMPLE>

      <QEXAMPLE>
	<SYNTAX>
	  <LINE>&pr; set_source(gal * (pl + clumin(gs)))</LINE>
	</SYNTAX>
	<DESC>
	  <PARA title="Luminosity of a component">
	    If the gaussian normalization is fixed to a non-zero
	    value then this calculates the unabsorbed luminosity and
	    error of the gaussian component.
	  </PARA>
	</DESC>
      </QEXAMPLE>

    </QEXAMPLELIST>

    <ADESC title="About Contributed Software">
      <PARA>
        This script is not an official part of the CIAO release but is
        made available as "contributed" software via the
        <HREF link="http://cxc.harvard.edu/ciao/download/scripts/">CIAO scripts page</HREF>.
        Please see this page for installation instructions - such as how to
        ensure that the parameter file is available.
      </PARA>
    </ADESC>

    <BUGS>
      <PARA>
	For a list of known bugs and issues with the XSPEC models, please visit
	the <HREF link="http://heasarc.gsfc.nasa.gov/docs/xanadu/xspec/bugs.html">XSPEC bugs page</HREF>.
      </PARA>
    </BUGS>
    
    <LASTMODIFIED>December 2018</LASTMODIFIED>
  </ENTRY>
</cxchelptopics>
